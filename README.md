### 开发规范



|  修改日期  | 修改说明 |
| :--------: | :------: |
| 2021.04.22 |  第一版  |
|            |          |
|            |          |



#### 一、命名规范

1. web模块和api模块的入参统一使用DTO，单字段接口除外
2. web模块和api模块的出参统一使用BaseResult(errCode,errMsg,data)
3. core模块入参统一使用DTO，单字段接口除外

#### 二、接口规范

1. 不同接口方法的入参和出参尽量避免继承依赖关系（分页除外），对外暴露的对象需要持久化
2. 接口命名需要知名见意，不要含义模糊，界限不清，如容易引起混淆，需加上注释说明和区别说明
3. 对外提供的HTTP接口请求类型，不建议使用GET请求，如果为了方便，可以统一使用POST请求，实体类参数统一使用@RequestBody注解修饰

#### 三、异常处理规范

1. 业务层异常，原则上不用处理，直接抛出，由web层统一处理，受检查异常处理后需抛出业务定义的异常
2. 对于使用远程调用的方式调用第三方服务接口，捕捉异常建议使用 Throwable类来进行拦截，并抛出业务定义异常；并且建议根据实际情况加上超时时间和降级保护处理
3. 对外提供的接口需做好异常信息的统一处理，禁止将服务内部异常堆栈信息暴露给调用者，需定义好统一规范的异常码和异常描述信息
4. 异常码统一规范，正常结果统一返回0，异常结果错误码统一为四位数字，第一位数字表示错误来源（1表示错误来源于用户；2表示错误来源于系统服务本身；3表示错误来源于第三方服务），后三位为数字编号，模块之间错误码应该留有间隔

#### 四、注释规范

1. 所有web层的接口和类上必须有清晰明了的注释信息，对于入参和出参实体类必须有注释信息；如果有校验，需要有校验说明
2. 为了可视化接口界面和自动生成接口文档方便，建议注释信息使用swagger注解
3. 对于复杂逻辑，建议有步骤注释说明

#### 五、日志规范

1. 所有web层的接口入参和出参必须要有日志打印，并输出相关参数
2. 日志API统一使用日志门面框架SLF4J API
3. 日志的配置文件需限制日志文件存储时间或者总大小
4. 对于service层的逻辑处理，建议在必要或者流程转换处条件判断处加上DEBUG或者INFO日志
5. 对于调用第三方服务接口，调用前和调用后必须加上参数和结果日志（注意：如果是引用第三方依赖包，直接用它们提供的实体类（仅仅用@Data注解，@CallSuper不为true或者没有设置）作为入参，如果实体类有继承关系，并且有核心字段是在父类中，不要直接日志输出参数为对象，父类属性值会打印不出来）

#### 六、数据库/ORM 规范

1. 建表的表名称和字段（容易成为关键字）建议加上业务/项目前缀标识，规避关键字
2. 禁止使用表外键关联
3. mysql bigint类型转化为java的Long类型时，如果是超长字段，并且数据需返回给前端，需要转化为String类型
4. SQL建议避免多表联查，在不严重影响性能的情况下，建议使用ORM框架通用SQL API 处理，数据拼装在代码层面实现
5. 要在ORM层面防止SQL注入



